{"ast":null,"code":"var _jsxFileName = \"/Users/davidmathews/Desktop/FULLSTACK ACADEMY/Projects/course_work/graceshopper/newamazon/src/components/Cart.js\",\n    _s2 = $RefreshSig$();\n\nimport \"./Components.css\";\nimport { Button, CardMedia, IconButton, Paper, Table, TableBody, TableCell, TableHead, TableRow } from \"@mui/material\";\nimport { makeStyles } from \"@mui/styles\";\nimport DeleteForeverIcon from \"@mui/icons-material/DeleteForever\";\nimport baseUrl from \"../api\";\nimport { useEffect, useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { SettingsOverscanOutlined, SettingsOverscanTwoTone } from \"@mui/icons-material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TAX_RATE = 0.07;\nconst useStyles = makeStyles({\n  header: {\n    marginLeft: \"30px\"\n  },\n  root: {\n    maxWidth: \"800px\",\n    marginTop: \"3em\",\n    overflowX: \"auto\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\"\n  },\n  table: {\n    minWidth: 500\n  },\n  row: {\n    backgroundColor: \"#8fc1e3\"\n  },\n  btn: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    margin: \"1rem\"\n  }\n});\n\nconst Cart = props => {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const cart = props.cart;\n  const history = useHistory();\n  const [updatedProduct, setUpdatedProduct] = useState({\n    productId: \"\",\n    quantity: \"\"\n  });\n\n  function ccyFormat(num) {\n    return `${Number(num).toFixed(2)}`;\n  }\n\n  let subtotal = 0;\n\n  if (cart.products) {\n    for (let product of cart.products) {\n      subtotal = product.price * product.quantity + subtotal;\n    }\n  }\n\n  const taxes = subtotal * TAX_RATE;\n  const invoiceTotal = subtotal + taxes; //=======================================================\n\n  const deleteProductFromCart = async (productId, localProductId) => {\n    if (props.user) {\n      await fetch(`${baseUrl}/cartItems/${productId}`, {\n        method: \"DELETE\",\n        headers: {\n          Authorization: `Bearer ${props.token}`\n        }\n      });\n    } else {\n      let localCart = JSON.parse(localStorage.getItem(\"localCart\"));\n\n      for (let i = 0; i < localCart.length; i++) {\n        if (localCart[i].product_id === localProductId) {\n          localCart.splice(i, 1);\n          localStorage.setItem(\"localCart\", JSON.stringify(localCart));\n          break;\n        }\n      }\n    }\n\n    console.log(\"working\");\n    props.getMyCart();\n  }; //=======================================================\n\n\n  const updateProductInCart = async localProductId => {\n    if (props.user) {\n      await fetch(`${baseUrl}/cartItems/${updatedProduct.productId}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${props.token}`\n        },\n        body: JSON.stringify({\n          quantity: updatedProduct.quantity\n        })\n      });\n    } else {\n      if (localStorage.getItem(\"localCart\")) {\n        let localCart = JSON.parse(localStorage.getItem(\"localCart\"));\n\n        for (let i = 0; i < localCart.length; i++) {\n          console.log(localCart[i].product_id, updatedProduct.localProductId);\n\n          if (localCart[i].product_id === updatedProduct.localProductId) {\n            localCart[i].quantity = updatedProduct.quantity;\n            localStorage.setItem(\"localCart\", JSON.stringify(localCart));\n            break;\n          }\n        }\n      }\n\n      console.log(\"working\");\n    }\n\n    props.getMyCart();\n  };\n\n  useEffect(() => {\n    updateProductInCart();\n  }, [updatedProduct]); //=======================================================\n\n  const Basket = () => {\n    _s();\n\n    const classes = useStyles();\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundImage: `url(\"images/library3.jpeg\")`,\n        backgroundRepeat: \"repeat\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: \"Shopping Cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Paper, {\n        className: classes.root,\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          className: classes.table,\n          children: [/*#__PURE__*/_jsxDEV(TableHead, {\n            children: /*#__PURE__*/_jsxDEV(TableRow, {\n              className: classes.row,\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Product\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: \"Qty.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: \"@\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: \"Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n            children: [(!cart.products || cart.products && cart.products.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginLeft: \"1em\",\n                marginTop: \"1em\",\n                fontSize: \"1.2em\"\n              },\n              children: \"There are no items in the cart.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 17\n            }, this), cart.products && cart.products.length > 0 && cart.products.map(product => /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                style: {\n                  display: \"flex\",\n                  alignItems: \"center\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${product.product_image}`,\n                  style: {\n                    height: \"5em\",\n                    marginRight: \"1em\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 23\n                }, this), product.product_name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"quantity\",\n                  value: product.quantity,\n                  onChange: e => {\n                    setUpdatedProduct({\n                      productId: product.id,\n                      localProductId: product.product_id,\n                      quantity: e.target.value\n                    });\n                  },\n                  children: [product.quantity === 1 ? /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"1\",\n                    selected: true,\n                    children: \"1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"1\",\n                    children: \"1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 196,\n                    columnNumber: 27\n                  }, this), product.quantity === 2 ? /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"2\",\n                    selected: true,\n                    children: \"2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 199,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"2\",\n                    children: \"2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 203,\n                    columnNumber: 27\n                  }, this), product.quantity === 3 ? /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"3\",\n                    selected: true,\n                    children: \"3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 206,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"3\",\n                    children: \"3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 210,\n                    columnNumber: 27\n                  }, this), product.quantity === 4 ? /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"4\",\n                    selected: true,\n                    children: \"4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 213,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"4\",\n                    children: \"4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 217,\n                    columnNumber: 27\n                  }, this), product.quantity === 5 ? /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"5\",\n                    selected: true,\n                    children: \"5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 220,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"5\",\n                    children: \"5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 224,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n                  children: /*#__PURE__*/_jsxDEV(DeleteForeverIcon, {\n                    onClick: () => deleteProductFromCart(product.id, product.product_id)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 228,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 227,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: product.price\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: ccyFormat(product.price * product.quantity)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 21\n              }, this)]\n            }, product.product_id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                rowSpan: 3\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                colSpan: 2,\n                children: \"Subtotal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: ccyFormat(subtotal)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                children: \"Tax\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: `${(TAX_RATE * 100).toFixed(0)} %`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: ccyFormat(taxes)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableRow, {\n              children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                colSpan: 2,\n                children: \"Total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                align: \"right\",\n                children: ccyFormat(invoiceTotal)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.btn,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            marginTop: \"1em\",\n            height: \"56px\",\n            justifyContent: \"center\",\n            backgroundColor: \"#8fc1e3\"\n          },\n          onClick: () => {\n            if (props.cart.products.length > 0) {\n              if (props.user) {\n                props.setTotal(ccyFormat(invoiceTotal));\n                props.setPurchaseDate(new Date().toDateString());\n                history.push(\"/checkout\");\n              } else {\n                props.setTotal(invoiceTotal);\n                props.setPurchaseDate(new Date().toDateString());\n                history.push(\"/checkout-redirect\");\n              }\n            }\n          },\n          type: \"submit\",\n          variant: \"contained\",\n          children: \"Proceed to Checkout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this);\n  };\n\n  _s(Basket, \"8g5FPXexvSEOsxdmU7HicukHGqY=\", false, function () {\n    return [useStyles];\n  });\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Basket, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 295,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(Cart, \"8r/1FnBYp5olR0jUBGVCgxQwLrk=\", false, function () {\n  return [useHistory];\n});\n\n_c = Cart;\nexport default Cart;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"sources":["/Users/davidmathews/Desktop/FULLSTACK ACADEMY/Projects/course_work/graceshopper/newamazon/src/components/Cart.js"],"names":["Button","CardMedia","IconButton","Paper","Table","TableBody","TableCell","TableHead","TableRow","makeStyles","DeleteForeverIcon","baseUrl","useEffect","useState","useHistory","SettingsOverscanOutlined","SettingsOverscanTwoTone","TAX_RATE","useStyles","header","marginLeft","root","maxWidth","marginTop","overflowX","marginRight","table","minWidth","row","backgroundColor","btn","display","justifyContent","margin","Cart","props","cart","history","updatedProduct","setUpdatedProduct","productId","quantity","ccyFormat","num","Number","toFixed","subtotal","products","product","price","taxes","invoiceTotal","deleteProductFromCart","localProductId","user","fetch","method","headers","Authorization","token","localCart","JSON","parse","localStorage","getItem","i","length","product_id","splice","setItem","stringify","console","log","getMyCart","updateProductInCart","body","Basket","classes","backgroundImage","backgroundRepeat","textAlign","fontSize","map","alignItems","product_image","height","product_name","e","id","target","value","setTotal","setPurchaseDate","Date","toDateString","push"],"mappings":"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","sourcesContent":["import \"./Components.css\";\nimport {\n  Button,\n  CardMedia,\n  IconButton,\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from \"@mui/material\";\nimport { makeStyles } from \"@mui/styles\";\nimport DeleteForeverIcon from \"@mui/icons-material/DeleteForever\";\nimport baseUrl from \"../api\";\nimport { useEffect, useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport {\n  SettingsOverscanOutlined,\n  SettingsOverscanTwoTone,\n} from \"@mui/icons-material\";\n\nconst TAX_RATE = 0.07;\n\nconst useStyles = makeStyles({\n  header: {\n    marginLeft: \"30px\",\n  },\n  root: {\n    maxWidth: \"800px\",\n    marginTop: \"3em\",\n    overflowX: \"auto\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n  },\n  table: {\n    minWidth: 500,\n  },\n  row: {\n    backgroundColor: \"#8fc1e3\",\n  },\n  btn: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    margin: \"1rem\",\n  },\n});\n\nconst Cart = (props) => {\n  const cart = props.cart;\n  const history = useHistory();\n  const [updatedProduct, setUpdatedProduct] = useState({\n    productId: \"\",\n    quantity: \"\",\n  });\n\n  function ccyFormat(num) {\n    return `${Number(num).toFixed(2)}`;\n  }\n\n  let subtotal = 0;\n\n  if (cart.products) {\n    for (let product of cart.products) {\n      subtotal = product.price * product.quantity + subtotal;\n    }\n  }\n  const taxes = subtotal * TAX_RATE;\n  const invoiceTotal = subtotal + taxes;\n\n  //=======================================================\n\n  const deleteProductFromCart = async (productId, localProductId) => {\n    if (props.user) {\n      await fetch(`${baseUrl}/cartItems/${productId}`, {\n        method: \"DELETE\",\n        headers: {\n          Authorization: `Bearer ${props.token}`,\n        },\n      });\n    } else {\n      let localCart = JSON.parse(localStorage.getItem(\"localCart\"));\n      for (let i = 0; i < localCart.length; i++) {\n        if (localCart[i].product_id === localProductId) {\n          localCart.splice(i, 1);\n          localStorage.setItem(\"localCart\", JSON.stringify(localCart));\n          break;\n        }\n      }\n    }\n    console.log(\"working\");\n    props.getMyCart();\n  };\n\n  //=======================================================\n\n  const updateProductInCart = async (localProductId) => {\n    if (props.user) {\n      await fetch(`${baseUrl}/cartItems/${updatedProduct.productId}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${props.token}`,\n        },\n        body: JSON.stringify({\n          quantity: updatedProduct.quantity,\n        }),\n      });\n    } else {\n      if (localStorage.getItem(\"localCart\")) {\n        let localCart = JSON.parse(localStorage.getItem(\"localCart\"));\n        for (let i = 0; i < localCart.length; i++) {\n          console.log(localCart[i].product_id, updatedProduct.localProductId);\n          if (localCart[i].product_id === updatedProduct.localProductId) {\n            localCart[i].quantity = updatedProduct.quantity;\n            localStorage.setItem(\"localCart\", JSON.stringify(localCart));\n            break;\n          }\n        }\n      }\n      console.log(\"working\");\n    }\n    props.getMyCart();\n  };\n\n  useEffect(() => {\n    updateProductInCart();\n  }, [updatedProduct]);\n\n  //=======================================================\n\n  const Basket = () => {\n    const classes = useStyles();\n\n    return (\n      <div\n        style={{\n          backgroundImage: `url(\"images/library3.jpeg\")`,\n          backgroundRepeat: \"repeat\",\n        }}\n      >\n        <h1 style={{ textAlign: \"center\" }}>Shopping Cart</h1>\n        <Paper className={classes.root}>\n          <Table className={classes.table}>\n            <TableHead>\n              <TableRow className={classes.row}>\n                <TableCell>Product</TableCell>\n                <TableCell align=\"right\">Qty.</TableCell>\n                <TableCell align=\"right\">@</TableCell>\n                <TableCell align=\"right\">Price</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {(!cart.products ||\n                (cart.products && cart.products.length === 0)) && (\n                <div\n                  style={{\n                    marginLeft: \"1em\",\n                    marginTop: \"1em\",\n                    fontSize: \"1.2em\",\n                  }}\n                >\n                  There are no items in the cart.\n                </div>\n              )}\n              {cart.products &&\n                cart.products.length > 0 &&\n                cart.products.map((product) => (\n                  <TableRow key={product.product_id}>\n                    <TableCell\n                      style={{ display: \"flex\", alignItems: \"center\" }}\n                    >\n                      <img\n                        src={`${product.product_image}`}\n                        style={{ height: \"5em\", marginRight: \"1em\" }}\n                      />\n                      {product.product_name}\n                    </TableCell>\n                    <TableCell align=\"right\">\n                      <select\n                        name=\"quantity\"\n                        value={product.quantity}\n                        onChange={(e) => {\n                          setUpdatedProduct({\n                            productId: product.id,\n                            localProductId: product.product_id,\n                            quantity: e.target.value,\n                          });\n                        }}\n                      >\n                        {product.quantity === 1 ? (\n                          <option value=\"1\" selected>\n                            1\n                          </option>\n                        ) : (\n                          <option value=\"1\">1</option>\n                        )}\n                        {product.quantity === 2 ? (\n                          <option value=\"2\" selected>\n                            2\n                          </option>\n                        ) : (\n                          <option value=\"2\">2</option>\n                        )}\n                        {product.quantity === 3 ? (\n                          <option value=\"3\" selected>\n                            3\n                          </option>\n                        ) : (\n                          <option value=\"3\">3</option>\n                        )}\n                        {product.quantity === 4 ? (\n                          <option value=\"4\" selected>\n                            4\n                          </option>\n                        ) : (\n                          <option value=\"4\">4</option>\n                        )}\n                        {product.quantity === 5 ? (\n                          <option value=\"5\" selected>\n                            5\n                          </option>\n                        ) : (\n                          <option value=\"5\">5</option>\n                        )}\n                      </select>\n                      <IconButton>\n                        <DeleteForeverIcon\n                          onClick={() =>\n                            deleteProductFromCart(\n                              product.id,\n                              product.product_id\n                            )\n                          }\n                        ></DeleteForeverIcon>\n                      </IconButton>\n                    </TableCell>\n                    <TableCell align=\"right\">{product.price}</TableCell>\n                    <TableCell align=\"right\">\n                      {ccyFormat(product.price * product.quantity)}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              <TableRow>\n                <TableCell rowSpan={3} />\n                <TableCell colSpan={2}>Subtotal</TableCell>\n                <TableCell align=\"right\">{ccyFormat(subtotal)}</TableCell>\n              </TableRow>\n              <TableRow>\n                <TableCell>Tax</TableCell>\n                <TableCell align=\"right\">{`${(TAX_RATE * 100).toFixed(\n                  0\n                )} %`}</TableCell>\n                <TableCell align=\"right\">{ccyFormat(taxes)}</TableCell>\n              </TableRow>\n              <TableRow>\n                <TableCell colSpan={2}>Total</TableCell>\n                <TableCell align=\"right\">{ccyFormat(invoiceTotal)}</TableCell>\n              </TableRow>\n            </TableBody>\n          </Table>\n        </Paper>\n        <div className={classes.btn}>\n          <Button\n            style={{\n              marginTop: \"1em\",\n              height: \"56px\",\n              justifyContent: \"center\",\n              backgroundColor: \"#8fc1e3\",\n            }}\n            onClick={() => {\n              if (props.cart.products.length > 0) {\n                if (props.user) {\n                  props.setTotal(ccyFormat(invoiceTotal));\n                  props.setPurchaseDate(new Date().toDateString());\n                  history.push(\"/checkout\");\n                } else {\n                  props.setTotal(invoiceTotal);\n                  props.setPurchaseDate(new Date().toDateString());\n                  history.push(\"/checkout-redirect\");\n                }\n              }\n            }}\n            type=\"submit\"\n            variant=\"contained\"\n          >\n            Proceed to Checkout\n          </Button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div>\n      <Basket></Basket>\n    </div>\n  );\n};\n\nexport default Cart;\n"]},"metadata":{},"sourceType":"module"}